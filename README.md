# xs_exploits
#### Gently packaged Cross-Site exploits

**WORK IN PROGRESS**


## Introduction
"xs_exploits" is an attempt to develop a standardized format for packaging Cross-Site exploits/attacks, such as XSS, CSRF, CSWH and similar.  
The packaged exploits, called exploit modules, could be be used by an attack tool such as [kkross](https://github.com/doctor-love/kkross).  
  
The purpose of this repository is to document the packaging format and act as collaborative collection of exploit modules.  

**Note:** The module structure definiton is not yet stable and all feedback is appreciated.  


## TL;DR example
```yaml
---
# ** xs_exploits module definition **
#
# Version of module structure, in order to enable future changes and backwards compatibility
structure_version: 0
data:
  module_type: csrf_get
  name: barfoo_app-add_user 
  description: Exploits functionality to add user

  metadata:
    # Arbitrary metadata for module (could be presented in a interface/be searchable)
    vendor: Barfoo Enterprises
    affected_versions: 4.3.0 > 5.9.1
    links:
      - http://seclists.org/2049/01/02

    exploit_version: 1
    developers:
      - Beta Provberg <beta@example.com>
      - Test Alphasson <test@example.com>

  # Options that can/must be configured by user before rendering of module
  options:
    - name: EMAIL
      description: Desired e-mail address of added user
      # option_type could be "string", "boolean" or "payload"
      option_type: string
      default: ""
      required: true

      # Specifies different types of limitations for the module option
      constraints:
        - constraint_type: length
          options:
            max: 25

  # Standard options that are inherited by the module
  inherited_options:
    - PROTO
    - HOST
    - PORT

  # Template for module redering (based on Jinja2)
  template: '<iframe src="{{ PROTO }}://{{ HOST }}:{{ PORT }}/actions/adduser.php?role=admin&email={{ EMAIL | urlencode }}"></iframe>'
  
  # Template for generating instance ID of module (based on Jinja2)
  # Defines the unique name of configured module in instance, in order to allow multiple use
  instance_id: '{{ PROTO }}://{{ HOST }}:{{ PORT }} - E: {{ EMAIL }}'

``` 


## Package format
Exploit modules are defined in a [YAML](http://yaml.org/) structure/document.  
The following sub-sections describes the various module properties:

### Top level properties

#### "structure_version"
**Type:** Integer  

Version of module structure definition. Used to allow future changes to the structure and backwards compatibility.  
Current value is "0", as the structure is not yet stable.  

#### "data"
**Type:** Dictionary  

Contains all other properties. Used to allow "clean" parsing with regards to future changes and backwards compatibility.  


### Data level properties

#### "module_type"
**Type:** String  

Describes the type of exploit the module contains. Could be an arbitrary value.  
Examples: "xss_get", "csrf_post", "cswh".  

#### "name"
**Type:** String  

Name of exploit module. Could be an arbitrary value.  
Used together with the "module_typ" property to define a unique ID of the exploit module. 
Examples: "confluence-update_post_permissions", "boot2docker-deploy_container". 

#### "description"
**Type:** String  

Describes what the exploit does. Could be an arbitrary value.  
Example: "Deploys a user specified container by exploiting lacking authentication for the Docker daemon TCP socket".  

#### "metadata"
**Type:** Dictionary containing arbitrary sub-properties

Property containing arbitrary metadata. Could contain things like CVE identifiers, links, exploit authors and similar.  
The metadata sub-properties could for example be displayed in a user interface or be searchable.  

Example:
```yaml
[...]
metadata:
  cve: CVE-2014-5280
  affected_applications:
    - Docker CE
    - boot2docker

  affected_versions: "< 1.2"
  links:
    - "https://groups.google.com/forum/#!msg/docker-announce/aQoVmQlcE0A/smPuBNYf8VwJ"
    - "https://vuldb.com/?id.112867"

  developers:
    - Beta Provberg <beta@example.com>
    - Test Alphasson <test@example.com>

[...]
```

#### "options"
**Type:** List containing dictionaries with "option" level properties

Contains zero or more "option" level properties. For more information, see "Option level properties".  
If no user configurable options are required, set value to a empty list ("[]").  

#### "inherited_options"
**Type:** List containing strings  

Contains zero or more strings that specifies names of standard options that should be inherited by the module.  
For more information, see "Inheritable options".  

If no options should be inherited, set value to a empty list ("[]").  

#### "template"
**Type:** String  

Jinja2 template string containg HTML code for the exploit.  
During the exploit rendering process, the configured options for the exploit are available as variables for the templating engine.  

Once rendered, the resulting string should produce a working exploit.  

Example:  
```yaml
[...]
  template: '<iframe src="{{ PROTO }}://{{ HOST }}:{{ PORT }}/actions/adduser.php?role=admin&email={{ EMAIL | urlencode }}"></iframe>'

[...]
```

For more information about the templating engine, see [Jinja2's official documentation](http://jinja.pocoo.org/docs/2.10/templates/)

**Note**:  
While work has been done to implement Jinja2 in other languages besides Python, it is not designed to be cross-platform.  
If you know of a better templating engine that has wide support in different languages and is not completly logicless, please let me know.  


#### "instance_id"
**Type:** String   

Jinja2 template string used to construct a unique ID for the configured exploit.  
During the exploit rendering process, the configured options for the exploit are available as variables for the templating engine.  

Example:  

```yaml
[...]
  instance_id: '{{ PROTO }}://{{ HOST }}:{{ PORT }} - E: {{ EMAIL }}'

[...]
```

For more information about the templating engine, see [Jinja2's official documentation](http://jinja.pocoo.org/docs/2.10/templates/)

**Note**:  
While work has been done to implement Jinja2 in other languages besides Python, it is not designed to be cross-platform.  
If you know of a better templating engine that has wide support in different languages and is not completely logicless, please let me know.   


### Option level properties
Options provides the user the ability to configure and customize the behavior of the exploit.  
The configured options are provided as variables to the templating engine and can be used during the rendering of exploit a [template](####-template) and [instance ID](####-instanceid).  

Some options may be required, such as "HOST" or "PROTO", while other could be voluntary, such as "SUBPATH" or "NO_REFER". 


 
